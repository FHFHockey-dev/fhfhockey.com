@use "sass:color";
@use "styles/vars" as v;

// =============================================
// Page Container
// =============================================
.page {
  min-height: 100vh;
  padding: clamp(v.$space-lg, 4vw, v.$space-xxl);
  background-color: v.$background-dark;
  color: v.$text-primary;
}

.pageContent {
  margin: 0 auto;
  width: 90%;
  display: flex;
  flex-direction: column;
  gap: v.$space-xl;
}

// =============================================
// Hero & Search Section
// =============================================
.hero {
  @include v.component-wrapper;
  background-color: v.$background-medium;
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
  padding: v.$space-lg;
  gap: v.$space-xl;
}

.titleInfo {
  display: flex;
  flex-direction: column;
  gap: v.$space-sm;
  text-align: left;
}

.heroTitle {
  font-family: v.$font-family-accent, sans-serif;
  font-size: clamp(2rem, 3vw, 2.5rem);
  text-transform: uppercase;
  font-weight: 700;
  letter-spacing: 0.08em;
  padding: 0;
  margin: 0;
}

.heroAccent {
  color: v.$primary-color;
  display: inline-block;
  padding-right: v.$space-sm;
}

.heroSubtitle {
  color: v.$text-secondary;
  font-size: v.$font-size-base;
  max-width: 50ch;
}

.searchForm {
  display: flex;
  flex-direction: column;
  gap: v.$space-sm;
  width: 100%;
  max-width: 400px;
  flex-shrink: 0;
}

.searchInputWrapper {
  position: relative;
  width: 100%;
}

.searchInput {
  width: 100%;
  border-radius: v.$border-radius-md;
  border: 1px solid v.$border-primary;
  background: v.$background-dark;
  color: v.$text-primary;
  padding: v.$space-sm v.$space-md;
  font-size: v.$font-size-base;
  transition: all 0.2s ease;

  &:focus {
    outline: none;
    border-color: v.$primary-color;
    box-shadow: v.$focus-ring-desktop;
  }

  &::placeholder {
    color: v.$text-secondary;
  }
}

.suggestionList {
  @include v.glass-panel(v.$space-xs, v.$border-radius-md);
  position: absolute;
  z-index: 10;
  margin-top: v.$space-xs;
  width: 100%;
  max-height: 300px;
  overflow-y: auto;
  @include v.custom-scrollbar(v.$primary-color, transparent, 6px);
}

.suggestionButton {
  @include v.reset-button;
  width: 100%;
  padding: v.$space-sm v.$space-md;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: v.$space-md;
  border-radius: v.$border-radius-sm;
  font-size: v.$font-size-sm;
  transition: background-color 0.15s ease;

  &:hover {
    background-color: rgba(v.$primary-color, 0.1);
  }

  & > span:last-child {
    color: v.$text-secondary;
  }
}

.suggestionActive {
  background-color: rgba(v.$primary-color, 0.15);
  color: v.$primary-color;
  font-weight: 600;
}

.searchButton {
  @include v.button-style;
  background: linear-gradient(
    135deg,
    v.$primary-color 0%,
    v.$secondary-color 100%
  );
  color: v.$color-white;
  border: none;
  font-family: v.$font-family-accent, sans-serif;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  padding: v.$space-sm v.$space-lg;

  &:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 8px 16px rgba(v.$primary-color, 0.3);
  }

  &:disabled {
    background: v.$color-grey-medium;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
  }
}

.errorMessage {
  margin-top: v.$space-sm;
  color: v.$danger-color;
  font-size: v.$font-size-sm;
  text-align: center;
}

.resultsPanel {
  margin-top: v.$space-lg;
  @include v.glass-panel(v.$space-lg, v.$border-radius-lg);
}

.resultsList {
  margin-top: v.$space-md;
  display: flex;
  flex-direction: column;
}

.resultButton {
  @include v.reset-button;
  width: 100%;
  padding: v.$space-sm v.$space-md;
  text-align: left;
  display: flex;
  justify-content: space-between;
  border-radius: v.$border-radius-md;
  transition: background-color 0.15s ease;

  &:hover {
    background-color: rgba(v.$primary-color, 0.08);
  }

  & > span:last-child {
    color: v.$text-secondary;
  }
}

// =============================================
// Power Ladder Section
// =============================================
.powerSection {
  @include v.component-wrapper;
  display: flex;
  flex-direction: column;
  gap: v.$space-lg;
  padding: v.$space-lg;
}

.sectionHeader {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  gap: v.$space-md;
  align-items: flex-start;
}

.sectionTitle {
  font-family: v.$font-family-accent, sans-serif;
  font-size: clamp(1.5rem, 2vw, 2rem);
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  margin: 0;
}

.sectionDescription {
  color: v.$text-secondary;
  font-size: v.$font-size-lg;
  font-variant-caps: all-petite-caps;
  max-width: 65ch;
  margin: v.$space-xs 0 0;
}

.sectionSubtitle {
  color: v.$primary-color;
  font-size: v.$font-size-md;
  font-family: v.$font-family-accent;
  margin: 0;
  text-transform: uppercase;
  max-width: 65ch;
  margin: v.$space-xs 0 0;
}

.sectionMeta {
  display: flex;
  gap: v.$space-lg;
  color: v.$text-secondary;
  font-size: v.$font-size-xs;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  flex-shrink: 0;
  text-align: right;
}

.powerGrid {
  display: grid;
  gap: v.$space-lg;
  grid-template-columns: minmax(0, 1.6fr) minmax(0, 0.75fr);
  align-items: start;
}

.powerTableWrapper {
  @include v.glass-panel(0, v.$border-radius-lg);
  overflow: hidden;
  border: 1px solid v.$border-primary;
}

.powerTableHead {
  display: grid;
  grid-template-columns: 70px 2.4fr repeat(8, 1.2fr);
  gap: v.$space-sm;
  padding: v.$space-md v.$space-lg;
  background-color: rgba(v.$background-dark, 0.8);
  border-bottom: 1px solid v.$border-primary;
  align-items: center;

  span,
  .sortButton {
    font-family: v.$font-family-accent;
    font-size: v.$font-size-xs;
    color: v.$text-secondary;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    text-align: center;

    &:nth-child(2) {
      // Team column
      text-align: left;
    }
  }
}

.sortButton {
  @include v.reset-button;
  cursor: pointer;
  transition: color 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;

  &:hover {
    color: v.$primary-color;
    text-shadow: 0 0 8px rgba(v.$primary-color, 0.5);
  }
}

.powerTable {
  list-style: none;
  margin: 0;
  padding: 0;
  width: 100%;
}

.powerRow {
  display: grid;
  grid-template-columns: 70px 2.4fr repeat(8, 1.2fr);
  gap: v.$space-sm;
  padding: v.$space-sm v.$space-md;
  align-items: center;
  border-bottom: 1px solid rgba(v.$border-primary, 0.5);
  transition: background-color 0.2s ease;

  &:last-child {
    border-bottom: none;
  }

  &:hover {
    background-color: rgba(v.$primary-color, 0.05);
  }
}

.powerRank {
  font-family: v.$font-family-numbers;
  font-size: v.$font-size-lg;
  font-weight: 700;
  color: v.$text-secondary;
  text-align: center;
}

.powerTeamCell {
  display: flex;
  align-items: center;
  gap: v.$space-md;
}

.powerTeamLogo {
  filter: drop-shadow(0 0 4px rgba(0, 0, 0, 0.5));
}

.powerTeamText {
  display: flex;
  flex-direction: column;
}

.powerTeamName {
  font-family: v.$font-family-primary;
  font-weight: 700;
  color: v.$text-primary;
  font-size: v.$font-size-base;
  margin: v.$space-xs;
}

.powerTeamMeta {
  font-size: v.$font-size-xs;
  color: v.$text-secondary;
}

.teamLogoWrapper {
  width: 34px;
  height: 34px;
  flex-shrink: 0;
}

.teamLogo {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

.powerScoreCell {
  display: flex;
  justify-content: center;
}

.driverTag {
  font-family: v.$font-family-numbers;
  font-weight: 700;
  font-size: v.$font-size-lg;
  padding: v.$space-xxs v.$space-sm;
  border-radius: v.$border-radius-sm;
  min-width: 60px;
  text-align: center;

  // Default/Neutral
  background: rgba(v.$text-secondary, 0.1);
  color: v.$text-primary;
  border: 1px solid rgba(v.$text-secondary, 0.2);
}

.powerValueCell {
  display: flex;
  justify-content: center;
}

.valuePill {
  font-family: v.$font-family-numbers;
  font-size: v.$font-size-sm;
  color: v.$text-secondary;
  padding: 2px 8px;
  border-radius: 4px;
  background: rgba(0, 0, 0, 0.2);
  min-width: 50px;
  text-align: center;
}

.tierElite {
  background: rgba(v.$primary-color, 0.15);
  color: v.$primary-color;
  border: 1px solid rgba(v.$primary-color, 0.4);
  box-shadow: 0 0 10px rgba(v.$primary-color, 0.1);
}

.tierGood {
  background-color: rgba(v.$success-color, 0.1);
  color: v.$success-color;
  border: 1px solid rgba(v.$success-color, 0.3);
}

.tierCaution {
  background-color: rgba(v.$warning-color, 0.1);
  color: v.$warning-color;
  border: 1px solid rgba(v.$warning-color, 0.3);
}

.tierPoor {
  background-color: rgba(v.$danger-color, 0.1);
  color: v.$danger-color;
  border: 1px solid rgba(v.$danger-color, 0.3);
}

.tierNeutral {
  background-color: rgba(v.$color-white, 0.1);
  color: v.$text-secondary;
  border: 1px solid v.$color-white;
}

.momentumCell {
  display: flex;
  flex-direction: column;
  gap: v.$space-xxs;
}

.momentumPill {
  display: inline-flex;
  align-items: center;
  gap: v.$space-xs;
  font-weight: 700;
  border-radius: v.$border-radius-sm;
  padding: v.$space-xxs v.$space-xs;
  font-size: v.$font-size-xs;
  border: 1px solid;
}

.momentumHot {
  @extend .tierElite;
}
.momentumWarm {
  @extend .tierGood;
}
.momentumNeutral {
  @extend .tierNeutral;
}
.momentumCool {
  @extend .tierCaution;
}
.momentumCold {
  @extend .tierPoor;
}

.momentumReason {
  color: v.$text-secondary;
  font-size: v.$font-size-xs;
}

.powerSidebar {
  display: grid;
  gap: v.$space-lg;
}

.hotColdCard {
  @include v.glass-panel(v.$space-md, v.$border-radius-lg);

  ul {
    display: block;
    list-style-type: disc;
    margin-block-start: 0;
    margin-block-end: 0;
    padding-inline-start: 0;
  }
}

.hotColdRow {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: v.$space-lg;
  padding: v.$space-sm 0;
  border-bottom: 1px solid v.$border-primary;

  &:last-child {
    border-bottom: none;
  }
}

.hotColdTeam {
  display: flex;
  align-items: center;
  gap: v.$space-md;
}

.hotColdMeta {
  color: v.$text-secondary;
  font-size: v.$font-size-xs;
  max-width: 240px;
  margin: v.$space-xs;
}

.sparkCell {
  margin-left: auto;
  min-width: 90px;
  @include v.glass-panel;
  padding: 2px 4px;
  border-radius: 6px;
  border: 1px solid v.$border-secondary;
  background: rgba(255, 255, 255, 0.03);
  box-shadow: 0 0 6px rgba(v.$primary-color, 0.2);
}

.sparkHot {
  border-color: v.$success-color;
  box-shadow: 0 0 8px rgba(v.$success-color, 0.35);
  background-color: rgba(v.$success-color, 0.08);
}

.sparkCold {
  border-color: v.$danger-color;
  box-shadow: 0 0 8px rgba(v.$danger-color, 0.35);
  background-color: rgba(v.$danger-color, 0.1);
}

.sparkSvg {
  width: 100%;
  height: 40px;
}

.sparkBaseline {
  stroke: rgba(v.$text-secondary, 0.35);
  stroke-width: 1;
}

.sparkArea {
  fill: rgba(v.$primary-color, 0.08);
}

.sparkPath {
  stroke-width: 2;
  fill: none;
}

.rise {
  stroke: v.$success-color;
  fill: rgba(v.$success-color, 0.16);
}

.fall {
  stroke: v.$danger-color;
  fill: rgba(v.$danger-color, 0.18);
}

.sparkEmpty {
  color: v.$text-secondary;
  font-size: 0.85rem;
}

// =============================================
// Dashboard Tabs & Charts
// =============================================
.topTabs {
  display: flex;
  gap: v.$space-xs;
  padding: 0 v.$space-xs;
  border-bottom: 1px solid v.$border-primary;
}

.tab {
  @include v.reset-button;
  font-family: v.$font-family-accent, sans-serif;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  padding: v.$space-sm v.$space-md;
  font-size: v.$font-size-base;
  color: v.$text-secondary;
  border-bottom: 2px solid transparent;
  margin-bottom: -1px;
  transition: all 0.2s ease;

  &:hover:not([aria-selected="true"]) {
    color: v.$text-primary;
    border-bottom-color: rgba(v.$primary-color, 0.3);
  }
}

.tabActive {
  color: v.$primary-color;
  font-weight: 700;
  border-bottom-color: v.$primary-color;
}

.subTabs {
  display: flex;
  gap: v.$space-sm;
  align-items: center;
  flex-wrap: wrap;
  padding-bottom: v.$space-md;
  border-bottom: 1px solid v.$border-primary;
}

.subTab {
  @include v.button-ghost(false);
}

.subTabActive {
  @include v.button-ghost(true);
}

.windowToggle {
  display: flex;
  align-items: center;
  margin-left: auto;
}

.windowButton {
  @include v.button-ghost(false);
  padding: v.$space-xs;
  min-width: 48px;
}

.windowActive {
  @include v.button-ghost(true);
}

.skaterControls {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  justify-content: flex-end;
  gap: v.$space-sm;
  margin-left: auto;

  select {
    @extend .searchInput; // reuse style from hero
    padding-right: v.$space-xl;
  }
}

.dashboardContent {
  @include v.component-wrapper;
  padding: v.$space-lg;
  background-color: v.$background-medium;
}

.trendGrid {
  display: grid;
  gap: v.$space-lg;
  grid-template-columns: minmax(320px, 0.8fr) minmax(0, 1.2fr);
}

.chartCard {
  @include v.component-wrapper;
  padding: v.$space-lg;
  background-color: v.$background-dark;
  display: flex;
  flex-direction: column;
  gap: v.$space-md;
}

.chartHeaderWrapper {
  display: flex;
  flex-direction: column;
  gap: v.$space-xs;
}

.chartTitleGroup {
  display: inline-flex;
  align-items: center;
  gap: v.$space-sm;
}

.chartHeading {
  font-family: v.$font-family-accent, sans-serif;
  font-size: v.$font-size-lg;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: v.$primary-color;
}

.infoWrapper {
  position: relative;
  display: inline-flex;
}

.infoButton {
  @include v.reset-button;
  display: inline-flex;
  color: v.$text-secondary;
  &:hover {
    color: v.$primary-color;
  }
}

.infoIcon {
  width: 18px;
  height: 18px;
}

.infoTooltip {
  @include v.glass-panel(v.$space-md, v.$border-radius-md);
  position: absolute;
  top: calc(100% + 8px);
  left: 50%;
  transform: translateX(-50%);
  z-index: 20;
  width: 320px;
  font-size: v.$font-size-sm;
  line-height: 1.5;
  opacity: 0;
  pointer-events: none;
  transition: all 0.2s ease;

  .infoWrapper:hover &,
  .infoWrapper:focus-within & {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
    pointer-events: auto;
  }

  strong,
  b {
    color: v.$text-primary;
    font-weight: 600;
  }
}

.infoList {
  margin: v.$space-sm 0 0;
  padding-left: v.$space-md;
  li {
    margin-bottom: v.$space-xs;
  }
}

.chartDescription {
  font-size: v.$font-size-sm;
  color: v.$text-secondary;
}

.chartShell {
  height: 320px;
}

.chartTheme {
  --chart-grid: #{v.$border-primary};
  --chart-tick: #{v.$text-secondary};
  --chart-cursor: #{rgba(v.$primary-color, 0.4)};
}

.chartEmpty,
.teamLoading,
.teamError {
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: v.$text-secondary;
  font-size: v.$font-size-base;
  border: 1px dashed v.$border-primary;
  border-radius: v.$border-radius-md;
}

.teamError {
  background-color: rgba(v.$danger-color, 0.1);
  color: v.$danger-color;
  border-color: rgba(v.$danger-color, 0.3);
}

.chartShellLarge {
  height: 520px;
}

.chartTooltip {
  @include v.glass-panel(v.$space-sm, v.$border-radius-md);
  min-width: 150px;
  display: flex;
  flex-direction: column;
  gap: v.$space-xs;
}

.chartTooltipHeader {
  display: flex;
  align-items: center;
  gap: v.$space-sm;
  font-weight: 700;
  font-size: v.$font-size-base;
}

.chartTooltipValue {
  font-size: v.$font-size-lg;
  font-family: v.$font-family-numbers, monospace;
  font-weight: 700;
  color: v.$text-primary;
}

.chartTooltipLabel {
  text-transform: uppercase;
  letter-spacing: 0.08em;
  font-size: v.$font-size-xs;
  color: v.$text-secondary;
}

.chartMovers {
  margin-top: v.$space-md;
}

.rankingCard {
  @include v.component-wrapper;
  background-color: v.$background-dark;
  padding: v.$space-lg;
  display: flex;
  flex-direction: column;
  gap: v.$space-md;
}

.rankingHeading {
  display: flex;
  flex-direction: column;
}

.rankingTitle {
  @extend .chartHeading;
}

.rankingMeta {
  @extend .chartDescription;
}

.rankingList {
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  gap: v.$space-sm;
}

.rankingRow {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: v.$space-sm;
  border-radius: v.$border-radius-md;
  background-color: v.$background-medium;
  border: 1px solid v.$border-primary;
}

.skaterRankingCard {
  @extend .chartCard;
}

.skaterRankingList {
  @extend .rankingList;
  max-height: 500px;
  overflow-y: auto;
  padding-right: v.$space-xs;
  @include v.custom-scrollbar(v.$primary-color, transparent, 6px);
}

.skaterRankingRow {
  @extend .rankingRow;
}

.skaterInfo {
  display: flex;
  align-items: center;
  gap: v.$space-md;
  min-width: 0;
}

.skaterHeadshotWrapper {
  width: 42px;
  height: 42px;
  border-radius: 50%;
  overflow: hidden;
  background: v.$background-dark;
  border: 1px solid v.$border-primary;
  flex-shrink: 0;
}

.skaterHeadshot {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.skaterText {
  display: flex;
  flex-direction: column;
  min-width: 0;
}

.skaterName {
  margin: 0;
  font-weight: 600;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.skaterMeta {
  margin: 0;
  font-size: v.$font-size-sm;
  color: v.$text-secondary;
}

.skaterScore {
  display: flex;
  align-items: center;
  gap: v.$space-md;
  font-family: v.$font-family-numbers, monospace;
}

.teamCell {
  display: flex;
  align-items: center;
  gap: v.$space-sm;
}

.rank {
  font-weight: 700;
  color: v.$text-secondary;
  width: 24px;
  text-align: center;
}

.deltaWrapper {
  width: 40px;
  text-align: center;
}

.delta {
  font-size: v.$font-size-xs;
  font-weight: 700;
  display: flex;
  align-items: center;
  gap: v.$space-xxs;
}

.deltaPositive {
  color: v.$success-color;
}
.deltaNegative {
  color: v.$danger-color;
}
.deltaNeutral {
  color: v.$text-secondary;
}

.percentile {
  font-size: v.$font-size-base;
  font-weight: 700;
  font-family: v.$font-family-numbers, monospace;
}

// =============================================
// Luck Badges
// =============================================
.luckWrapper {
  display: grid;
  place-items: center;
  position: relative;
}

.luckWrapper > * {
  grid-area: 1 / 1;
}

.luckWrapper .valuePill {
  transition: opacity 0.5s ease;
}

.luckBadge {
  font-size: 9px;
  font-weight: 800;
  text-transform: uppercase;
  padding: 2px 8px;
  border-radius: 4px;
  letter-spacing: 0.05em;
  min-width: 50px;
  width: 100%;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  opacity: 0;
  transition: opacity 0.5s ease;
  z-index: 2;
}

.hasBadge:hover .luckBadge {
  opacity: 1;
}

.hasBadge:hover .valuePill {
  opacity: 0;
}

.luckLucky {
  background-color: rgba(v.$success-color, 0.2);
  color: v.$success-color;
  border: 1px solid rgba(v.$success-color, 0.4);
}

.luckUnlucky {
  background-color: rgba(v.$danger-color, 0.2);
  color: v.$danger-color;
  border: 1px solid rgba(v.$danger-color, 0.4);
}

// =============================================
// Responsive
// =============================================
@media (max-width: v.$breakpoint-desktop) {
  .powerGrid {
    grid-template-columns: 1fr;
  }
  .trendGrid {
    grid-template-columns: 1fr;
  }
}

@media (max-width: v.$breakpoint-tablet) {
  .page {
    padding: v.$space-lg v.$space-md;
  }
  .hero {
    flex-direction: column;
    align-items: flex-start;
    text-align: left;
  }
  .searchForm {
    max-width: none;
  }
  .powerRow,
  .powerTableHead {
    grid-template-columns: 32px 1fr 1fr;
    .powerDriverCell,
    .powerScoreCell,
    .powerValueCell:nth-child(n + 5),
    .momentumCell {
      display: none;
    }
  }
}
