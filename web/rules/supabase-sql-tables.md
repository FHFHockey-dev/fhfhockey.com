wgo_skater_stats_totals table:
```sql
create table public.wgo_skater_stats_totals (
  player_id integer not null,
  player_name text null,
  season text not null,
  shoots_catches text null,
  position_code text null,
  games_played integer null,
  points integer null,
  points_per_game double precision null,
  goals integer null,
  assists integer null,
  shots integer null,
  shooting_percentage double precision null,
  plus_minus integer null,
  ot_goals integer null,
  gw_goals integer null,
  pp_points integer null,
  fow_percentage double precision null,
  toi_per_game double precision null,
  blocked_shots integer null,
  blocks_per_60 double precision null,
  empty_net_goals integer null,
  empty_net_points integer null,
  giveaways integer null,
  giveaways_per_60 double precision null,
  hits integer null,
  hits_per_60 double precision null,
  missed_shots integer null,
  takeaways integer null,
  takeaways_per_60 double precision null,
  d_zone_fo_percentage double precision null,
  d_zone_faceoffs integer null,
  ev_faceoff_percentage double precision null,
  ev_faceoffs integer null,
  n_zone_fo_percentage double precision null,
  n_zone_faceoffs integer null,
  o_zone_fo_percentage double precision null,
  o_zone_faceoffs integer null,
  pp_faceoff_percentage double precision null,
  pp_faceoffs integer null,
  sh_faceoff_percentage double precision null,
  sh_faceoffs integer null,
  total_faceoffs integer null,
  d_zone_fol integer null,
  d_zone_fow integer null,
  ev_fol integer null,
  ev_fow integer null,
  n_zone_fol integer null,
  n_zone_fow integer null,
  o_zone_fol integer null,
  o_zone_fow integer null,
  pp_fol integer null,
  pp_fow integer null,
  sh_fol integer null,
  sh_fow integer null,
  total_fol integer null,
  total_fow integer null,
  es_goals_against integer null,
  es_goals_for integer null,
  es_goals_for_percentage double precision null,
  es_toi_per_game double precision null,
  pp_goals_against integer null,
  pp_goals_for integer null,
  pp_toi_per_game double precision null,
  sh_goals_against integer null,
  sh_goals_for integer null,
  sh_toi_per_game double precision null,
  game_misconduct_penalties integer null,
  major_penalties integer null,
  match_penalties integer null,
  minor_penalties integer null,
  misconduct_penalties integer null,
  penalties integer null,
  penalties_drawn integer null,
  penalties_drawn_per_60 double precision null,
  penalties_taken_per_60 double precision null,
  penalty_minutes integer null,
  penalty_minutes_per_toi double precision null,
  penalty_seconds_per_game double precision null,
  pp_goals_against_per_60 double precision null,
  sh_assists integer null,
  sh_goals integer null,
  sh_points integer null,
  sh_goals_per_60 double precision null,
  sh_individual_sat_for integer null,
  sh_individual_sat_per_60 double precision null,
  sh_points_per_60 double precision null,
  sh_primary_assists integer null,
  sh_primary_assists_per_60 double precision null,
  sh_secondary_assists integer null,
  sh_secondary_assists_per_60 double precision null,
  sh_shooting_percentage double precision null,
  sh_shots integer null,
  sh_shots_per_60 double precision null,
  sh_time_on_ice integer null,
  sh_time_on_ice_pct_per_game double precision null,
  pp_assists integer null,
  pp_goals integer null,
  pp_goals_for_per_60 double precision null,
  pp_goals_per_60 double precision null,
  pp_individual_sat_for integer null,
  pp_individual_sat_per_60 double precision null,
  pp_points_per_60 double precision null,
  pp_primary_assists integer null,
  pp_primary_assists_per_60 double precision null,
  pp_secondary_assists integer null,
  pp_secondary_assists_per_60 double precision null,
  pp_shooting_percentage double precision null,
  pp_shots integer null,
  pp_shots_per_60 double precision null,
  pp_toi integer null,
  pp_toi_pct_per_game double precision null,
  goals_pct double precision null,
  faceoff_pct_5v5 double precision null,
  individual_sat_for_per_60 double precision null,
  individual_shots_for_per_60 double precision null,
  on_ice_shooting_pct double precision null,
  sat_pct double precision null,
  toi_per_game_5v5 double precision null,
  usat_pct double precision null,
  zone_start_pct double precision null,
  sat_against integer null,
  sat_ahead integer null,
  sat_behind integer null,
  sat_close integer null,
  sat_for integer null,
  sat_tied integer null,
  sat_total integer null,
  usat_against integer null,
  usat_ahead integer null,
  usat_behind integer null,
  usat_close integer null,
  usat_for integer null,
  usat_tied integer null,
  usat_total integer null,
  sat_percentage double precision null,
  sat_percentage_ahead double precision null,
  sat_percentage_behind double precision null,
  sat_percentage_close double precision null,
  sat_percentage_tied double precision null,
  sat_relative double precision null,
  shooting_percentage_5v5 double precision null,
  skater_save_pct_5v5 double precision null,
  skater_shooting_plus_save_pct_5v5 double precision null,
  usat_percentage double precision null,
  usat_percentage_ahead double precision null,
  usat_percentage_behind double precision null,
  usat_percentage_close double precision null,
  usat_percentage_tied double precision null,
  usat_relative double precision null,
  zone_start_pct_5v5 double precision null,
  assists_5v5 integer null,
  assists_per_60_5v5 double precision null,
  goals_5v5 integer null,
  goals_per_60_5v5 double precision null,
  o_zone_start_pct_5v5 double precision null,
  on_ice_shooting_pct_5v5 double precision null,
  points_5v5 integer null,
  points_per_60_5v5 double precision null,
  primary_assists_5v5 integer null,
  primary_assists_per_60_5v5 double precision null,
  sat_relative_5v5 double precision null,
  secondary_assists_5v5 integer null,
  secondary_assists_per_60_5v5 double precision null,
  total_primary_assists integer null,
  total_secondary_assists integer null,
  goals_backhand integer null,
  goals_bat integer null,
  goals_between_legs integer null,
  goals_cradle integer null,
  goals_deflected integer null,
  goals_poke integer null,
  goals_slap integer null,
  goals_snap integer null,
  goals_tip_in integer null,
  goals_wrap_around integer null,
  goals_wrist integer null,
  shots_on_net_backhand integer null,
  shots_on_net_bat integer null,
  shots_on_net_between_legs integer null,
  shots_on_net_cradle integer null,
  shots_on_net_deflected integer null,
  shots_on_net_poke integer null,
  shots_on_net_slap integer null,
  shots_on_net_snap integer null,
  shots_on_net_tip_in integer null,
  shots_on_net_wrap_around integer null,
  shots_on_net_wrist integer null,
  ev_time_on_ice integer null,
  ev_time_on_ice_per_game double precision null,
  ot_time_on_ice integer null,
  ot_time_on_ice_per_game double precision null,
  shifts integer null,
  shifts_per_game double precision null,
  time_on_ice_per_shift double precision null,
  birth_city text null,
  birth_date text null,
  current_team_abbreviation text null,
  current_team_name text null,
  draft_overall integer null,
  draft_round integer null,
  draft_year integer null,
  first_season_for_game_type integer null,
  nationality_code text null,
  weight integer null,
  height integer null,
  birth_country text null,
  updated_at timestamp with time zone null,
  constraint wgo_skater_stats_totals_pkey primary key (player_id, season),
  constraint unique_player_season unique (player_id, season)
) TABLESPACE pg_default;

create unique INDEX IF not exists idx_wgo_skater_stats_totals_player_season on public.wgo_skater_stats_totals using btree (player_id, season) TABLESPACE pg_default;
```

`player_stats_unified` materialized view:
```sql 
 SELECT w.player_id,
    w.date,
    w.season_id,
    p.team_id,
    w.player_name,
    w.position_code,
    w.shoots_catches,
    w.games_played,
    w.points,
    w.goals,
    w.assists,
    w.shots,
    w.shooting_percentage,
    w.plus_minus,
    w.gw_goals,
    w.pp_points,
    w.sh_points,
    w.fow_percentage,
    w.toi_per_game,
    w.penalty_minutes,
    w.hits,
    w.blocked_shots,
    w.takeaways,
    w.giveaways,
    w.d_zone_fo_percentage,
    w.d_zone_faceoffs,
    w.ev_faceoff_percentage,
    w.ev_faceoffs,
    w.n_zone_fo_percentage,
    w.n_zone_faceoffs,
    w.o_zone_fo_percentage,
    w.o_zone_faceoffs,
    w.total_faceoffs,
    w.total_fol,
    w.total_fow,
    w.es_goals_against,
    w.es_goals_for,
    w.es_goals_for_percentage,
    w.es_toi_per_game,
    w.pp_assists,
    w.pp_goals,
    w.pp_goals_against,
    w.pp_goals_for,
    w.pp_goals_for_per_60,
    w.pp_goals_per_60,
    w.pp_individual_sat_for,
    w.pp_individual_sat_per_60,
    w.pp_points_per_60,
    w.pp_primary_assists,
    w.pp_primary_assists_per_60,
    w.pp_secondary_assists,
    w.pp_secondary_assists_per_60,
    w.pp_shooting_percentage,
    w.pp_shots,
    w.pp_shots_per_60,
    w.pp_toi,
    w.pp_toi_pct_per_game,
    w.sh_assists,
    w.sh_goals,
    w.sh_goals_per_60,
    w.sh_primary_assists,
    w.sh_primary_assists_per_60,
    w.sh_secondary_assists,
    w.sh_secondary_assists_per_60,
    w.sh_shooting_percentage,
    w.sh_shots,
    w.sh_time_on_ice,
    w.penalties,
    w.penalties_drawn,
    w.goals_pct,
    w.faceoff_pct_5v5,
    w.individual_sat_for_per_60,
    w.individual_shots_for_per_60,
    w.on_ice_shooting_pct,
    w.sat_pct,
    w.toi_per_game_5v5,
    w.zone_start_pct,
    w.shooting_percentage_5v5,
    w.skater_save_pct_5v5,
    w.skater_shooting_plus_save_pct_5v5,
    w.zone_start_pct_5v5,
    w.assists_5v5,
    w.assists_per_60_5v5,
    w.goals_5v5,
    w.goals_per_60_5v5,
    w.o_zone_start_pct_5v5,
    w.on_ice_shooting_pct_5v5,
    w.points_5v5,
    w.points_per_60_5v5,
    w.primary_assists_5v5,
    w.primary_assists_per_60_5v5,
    w.secondary_assists_5v5,
    w.secondary_assists_per_60_5v5,
    w.total_primary_assists,
    w.total_secondary_assists,
    w.ev_time_on_ice,
    w.shifts,
    w.time_on_ice_per_shift,
    w.missed_shots,
    nc.toi AS nst_toi,
    nc.first_assists AS nst_first_assists,
    nc.second_assists AS nst_second_assists,
    nc.ipp AS nst_ipp,
    nc.ixg AS nst_ixg,
    nc.icf AS nst_icf,
    nc.iff AS nst_iff,
    nc.iscfs AS nst_iscfs,
    nc.hdcf AS nst_hdcf,
    nc.rush_attempts AS nst_rush_attempts,
    nc.rebounds_created AS nst_rebounds_created,
    nc.penalties_drawn AS nst_penalties_drawn,
    nc.hits_taken AS nst_hits_taken,
    nc.faceoffs_won AS nst_faceoffs_won,
    nc.faceoffs_lost AS nst_faceoffs_lost,
    nco.cf AS nst_oi_cf,
    nco.ca AS nst_oi_ca,
    nco.cf_pct AS nst_oi_cf_pct,
    nco.ff AS nst_oi_ff,
    nco.fa AS nst_oi_fa,
    nco.ff_pct AS nst_oi_ff_pct,
    nco.sf AS nst_oi_sf,
    nco.sa AS nst_oi_sa,
    nco.sf_pct AS nst_oi_sf_pct,
    nco.gf AS nst_oi_gf,
    nco.ga AS nst_oi_ga,
    nco.gf_pct AS nst_oi_gf_pct,
    nco.xgf AS nst_oi_xgf,
    nco.xga AS nst_oi_xga,
    nco.xgf_pct AS nst_oi_xgf_pct,
    nco.scf AS nst_oi_scf,
    nco.sca AS nst_oi_sca,
    nco.scf_pct AS nst_oi_scf_pct,
    nco.hdcf AS nst_oi_hdcf,
    nco.hdca AS nst_oi_hdca,
    nco.hdcf_pct AS nst_oi_hdcf_pct,
    nco.hdgf AS nst_oi_hdgf,
    nco.hdga AS nst_oi_hdga,
    nco.hdgf_pct AS nst_oi_hdgf_pct,
    nco.mdcf AS nst_oi_mdcf,
    nco.mdca AS nst_oi_mdca,
    nco.mdcf_pct AS nst_oi_mdcf_pct,
    nco.mdgf AS nst_oi_mdgf,
    nco.mdga AS nst_oi_mdga,
    nco.mdgf_pct AS nst_oi_mdgf_pct,
    nco.ldcf AS nst_oi_ldcf,
    nco.ldca AS nst_oi_ldca,
    nco.ldgf AS nst_oi_ldgf,
    nco.ldga AS nst_oi_ldga,
    nco.on_ice_sh_pct AS nst_oi_shooting_pct,
    nco.on_ice_sv_pct AS nst_oi_save_pct,
    nco.pdo AS nst_oi_pdo,
    nco.off_zone_starts AS nst_oi_off_zone_starts,
    nco.neu_zone_starts AS nst_oi_neu_zone_starts,
    nco.def_zone_starts AS nst_oi_def_zone_starts,
    nco.off_zone_start_pct AS nst_oi_off_zone_start_pct,
    nr.goals_per_60 AS nst_goals_per_60,
    nr.total_assists_per_60 AS nst_assists_per_60,
    nr.first_assists_per_60 AS nst_first_assists_per_60,
    nr.second_assists_per_60 AS nst_second_assists_per_60,
    nr.total_points_per_60 AS nst_points_per_60,
    nr.shots_per_60 AS nst_shots_per_60,
    nr.ixg_per_60 AS nst_ixg_per_60,
    nr.icf_per_60 AS nst_icf_per_60,
    nr.iff_per_60 AS nst_iff_per_60,
    nr.iscfs_per_60 AS nst_iscfs_per_60,
    nr.hdcf_per_60 AS nst_hdcf_per_60,
    nr.rush_attempts_per_60 AS nst_rush_attempts_per_60,
    nr.rebounds_created_per_60 AS nst_rebounds_created_per_60,
    nr.pim_per_60 AS nst_pim_per_60,
    nr.penalties_drawn_per_60 AS nst_penalties_drawn_per_60,
    nr.giveaways_per_60 AS nst_giveaways_per_60,
    nr.takeaways_per_60 AS nst_takeaways_per_60,
    nr.hits_per_60 AS nst_hits_per_60,
    nr.shots_blocked_per_60 AS nst_shots_blocked_per_60,
    nr.faceoffs_won_per_60 AS nst_faceoffs_won_per_60,
    nr.faceoffs_lost_per_60 AS nst_faceoffs_lost_per_60,
    nr.hits_taken_per_60 AS nst_hits_taken_per_60,
    nro.cf_per_60 AS nst_oi_cf_per_60,
    nro.ca_per_60 AS nst_oi_ca_per_60,
    nro.cf_pct AS nst_oi_cf_pct_rates,
    nro.ff_per_60 AS nst_oi_ff_per_60,
    nro.fa_per_60 AS nst_oi_fa_per_60,
    nro.ff_pct AS nst_oi_ff_pct_rates,
    nro.sf_per_60 AS nst_oi_sf_per_60,
    nro.sa_per_60 AS nst_oi_sa_per_60,
    nro.sf_pct AS nst_oi_sf_pct_rates,
    nro.gf_per_60 AS nst_oi_gf_per_60,
    nro.ga_per_60 AS nst_oi_ga_per_60,
    nro.gf_pct AS nst_oi_gf_pct_rates,
    nro.xgf_per_60 AS nst_oi_xgf_per_60,
    nro.xga_per_60 AS nst_oi_xga_per_60,
    nro.xgf_pct AS nst_oi_xgf_pct_rates,
    nro.scf_per_60 AS nst_oi_scf_per_60,
    nro.sca_per_60 AS nst_oi_sca_per_60,
    nro.scf_pct AS nst_oi_scf_pct_rates,
    nro.hdcf_per_60 AS nst_oi_hdcf_per_60,
    nro.hdca_per_60 AS nst_oi_hdca_per_60,
    nro.hdcf_pct AS nst_oi_hdcf_pct_rates,
    nro.hdgf_per_60 AS nst_oi_hdgf_per_60,
    nro.hdga_per_60 AS nst_oi_hdga_per_60,
    nro.hdgf_pct AS nst_oi_hdgf_pct_rates,
    nro.mdcf_per_60 AS nst_oi_mdcf_per_60,
    nro.mdca_per_60 AS nst_oi_mdca_per_60,
    nro.mdcf_pct AS nst_oi_mdcf_pct_rates,
    nro.mdgf_per_60 AS nst_oi_mdgf_per_60,
    nro.mdga_per_60 AS nst_oi_mdga_per_60,
    nro.mdgf_pct AS nst_oi_mdgf_pct_rates,
    nro.ldcf_per_60 AS nst_oi_ldcf_per_60,
    nro.ldca_per_60 AS nst_oi_ldca_per_60,
    nro.ldcf_pct AS nst_oi_ldcf_pct_rates,
    nro.ldgf_per_60 AS nst_oi_ldgf_per_60,
    nro.ldga_per_60 AS nst_oi_ldga_per_60,
    nro.ldgf_pct AS nst_oi_ldgf_pct_rates,
    nro.on_ice_sh_pct AS nst_oi_sh_pct_rates,
    nro.on_ice_sv_pct AS nst_oi_sv_pct_rates,
    nro.pdo AS nst_oi_pdo_rates,
    nro.off_zone_starts_per_60 AS nst_oi_off_zone_starts_per_60,
    nro.neu_zone_starts_per_60 AS nst_oi_neu_zone_starts_per_60,
    nro.def_zone_starts_per_60 AS nst_oi_def_zone_starts_per_60,
    nro.off_zone_start_pct AS nst_oi_off_zone_start_pct_rates,
        CASE
            WHEN nc.player_id IS NOT NULL THEN true
            ELSE false
        END AS has_nst_counts,
        CASE
            WHEN nco.player_id IS NOT NULL THEN true
            ELSE false
        END AS has_nst_counts_oi,
        CASE
            WHEN nr.player_id IS NOT NULL THEN true
            ELSE false
        END AS has_nst_rates,
        CASE
            WHEN nro.player_id IS NOT NULL THEN true
            ELSE false
        END AS has_nst_rates_oi,
    COALESCE(w.shots, 0) AS shots_safe,
    COALESCE(w.shooting_percentage, 0::double precision) AS shooting_pct_safe,
    COALESCE(nco.cf_pct, 0.5::double precision) AS possession_pct_safe,
    CURRENT_TIMESTAMP AS materialized_at
   FROM wgo_skater_stats w
     LEFT JOIN players p ON w.player_id = p.id
     LEFT JOIN nst_gamelog_as_counts nc ON w.player_id = nc.player_id AND w.date = nc.date_scraped AND w.season_id = nc.season
     LEFT JOIN nst_gamelog_as_counts_oi nco ON w.player_id = nco.player_id AND w.date = nco.date_scraped AND w.season_id = nco.season
     LEFT JOIN nst_gamelog_as_rates nr ON w.player_id = nr.player_id AND w.date = nr.date_scraped AND w.season_id = nr.season
     LEFT JOIN nst_gamelog_as_rates_oi nro ON w.player_id = nro.player_id AND w.date = nro.date_scraped AND w.season_id = nro.season
  WHERE w.games_played = 1 AND w.date >= '2023-01-01'::date AND w.player_id IS NOT NULL AND w.date IS NOT NULL
  ORDER BY w.player_id, w.date;
  ```

